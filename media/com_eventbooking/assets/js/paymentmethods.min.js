function PaymentMethod(e,t,a,n,r){this.name=e,this.creditCard=t,this.cardType=a,this.cardCvv=n,this.cardHolderName=r}function PaymentMethods(){this.length=0,this.methods=[]}function removeSpace(e){e.value=e.value.replace(/\s/g,"")}PaymentMethod.prototype.getName=function(){return this.name},PaymentMethod.prototype.getCreditCard=function(){return this.creditCard},PaymentMethod.prototype.getCardType=function(){return this.cardType},PaymentMethod.prototype.getCardCvv=function(){return this.cardCvv},PaymentMethod.prototype.getCardHolderName=function(){return this.cardHolderName},PaymentMethods.prototype.Add=function(e){this.methods[this.length]=e,this.length=this.length+1},PaymentMethods.prototype.Find=function(e){for(var t=0;t<this.length;t++)if(this.methods[t].name==e)return this.methods[t];return null},EBMaskInputs=function(e){e.querySelectorAll("input[data-input-mask]").forEach(function(e){var t=e.dataset.inputMask;"/"===t.slice(0,1)&&"/"===t.slice(-1)&&(t=(t=t.slice(1)).slice(0,-1),t=new RegExp(t));IMask(e,{mask:t})})},function(o){updatePaymentMethod=function(){var e,t;e=o("input:radio[name^=payment_method]").length?o("input:radio[name^=payment_method]:checked").val():o("input[name^=payment_method]").val(),(t=methods.Find(e))&&(t.getCreditCard()?(o("#tr_card_number").show(),o("#tr_exp_date").show(),o("#tr_cvv_code").show(),t.getCardType()?o("#tr_card_type").show():o("#tr_card_type").hide(),t.getCardHolderName()?o("#tr_card_holder_name").show():o("#tr_card_holder_name").hide()):(o("#tr_card_number").hide(),o("#tr_exp_date").hide(),o("#tr_cvv_code").hide(),o("#tr_card_type").hide(),o("#tr_card_holder_name").hide()),0===e.indexOf("os_squareup")?o("#sq_field_zipcode").show():o("#sq_field_zipcode").hide(),"undefined"!=typeof stripe&&(0===e.indexOf("os_stripe")?o("#stripe-card-form").show():o("#stripe-card-form").hide()),0===e.indexOf("os_squarecard")?o("#square-card-form").show():o("#square-card-form").hide(),ebShowPaymentMethodFields(e))},changePaymentMethod=function(e){updatePaymentMethod(),1==document.adminForm.show_payment_fee.value&&("individual"===e?calculateIndividualRegistrationFee:"group"===e?calculateGroupRegistrationFee:calculateCartRegistrationFee)()},showHideDependFields=function(e,t,a,n){var r,d=o("#ajax-loading-animation");d.show(),r=n?".master-field-"+n+" input[type='checkbox']:checked, .master-field-"+n+" input[type='radio']:checked, .master-field-"+n+" select":".master-field input[type='checkbox']:checked, .master-field input[type='radio']:checked, .master-field select",o.ajax({type:"POST",url:siteUrl+"index.php?option=com_eventbooking&task=get_depend_fields_status&field_id="+e+"&field_suffix="+n+langLinkForAjax,data:o(r),dataType:"json",success:function(e,t,a){d.hide();var n,r=[],i=[];for(0<e.hide_fields.length&&(r=e.hide_fields.split(",")),0<e.show_fields.length&&(i=e.show_fields.split(",")),n=0;n<r.length;n++)o("#"+r[n]).hide();for(n=0;n<i.length;n++)o("#"+i[n]).show();"undefined"==typeof eb_current_page||("default"===eb_current_page?calculateIndividualRegistrationFee():"group_billing"===eb_current_page?calculateGroupRegistrationFee():"cart"===eb_current_page&&calculateCartRegistrationFee())},error:function(e,t,a){alert(t)}})},buildStateFields=function(a,e,n){var t=o("#"+e),r=o("#"+a),i=Joomla.getOptions("taxStateCountries");t.length&&r.length&&r.is("select")&&t.change(function(){var t=o(this).val();o.ajax({type:"GET",url:siteUrl+"index.php?option=com_eventbooking&task=get_states&country_name="+t+"&field_name="+a+"&state_name="+n+langLinkForAjax,success:function(e){o("#field_"+a+" .eb-form-control").length?o("#field_"+a+" .eb-form-control").html(e):o("#field_"+a+" .controls").length?o("#field_"+a+" .controls").html(e):o("#field_"+a+" .col-sm-9").length?o("#field_"+a+" .col-sm-9").html(e):o("#field_"+a+" .col-md-9").length?o("#field_"+a+" .col-md-9").html(e):o("#field_"+a+" .uk-form-controls").html(e),"state"===a&&-1!==i.indexOf(t)&&o("#state").change(function(){"default"===eb_current_page?calculateIndividualRegistrationFee():"group_billing"===eb_current_page?calculateGroupRegistrationFee():"cart"===eb_current_page&&calculateCartRegistrationFee()})},error:function(e,t,a){alert(t)}})})},showDepositAmount=function(e){1==o(e).val()?o("#deposit_amount_container").show():o("#deposit_amount_container").hide()},createStripeCardElement=function(){if("undefined"!=typeof stripe&&0!==o("#stripe-card-element").length){if(null===stripeCard){stripeCard=elements.create("card",{style:{base:{fontSize:"16px",color:"#32325d"}}})}stripeCard.mount("#stripe-card-element")}},paymentMethodCallbackHandle=function(){var e;if(void 0===(e=o('input:radio[name="payment_method"]').length?o('input:radio[name="payment_method"]:checked').val():o('input[name="payment_method"]').val()))return!0;if(0===e.indexOf("os_stripe")){if("undefined"!=typeof stripePublicKey&&o("#tr_card_number").is(":visible"))return Stripe.card.createToken({number:o("#x_card_num").val(),cvc:o("#x_card_code").val(),exp_month:o("select[name^=exp_month]").val(),exp_year:o("select[name^=exp_year]").val(),name:o("#card_holder_name").val()},stripeResponseHandler),!1;if("undefined"!=typeof stripe&&o("#stripe-card-form").is(":visible"))return stripe.createToken(stripeCard).then(function(e){e.error?alert(e.error.message):stripeTokenHandler(e.token)}),!1}return 0===e.indexOf("os_squareup")&&o("#tr_card_number").is(":visible")?(sqPaymentForm.requestCardNonce(),!1):0!==e.indexOf("os_squarecard")||!o("#square-card-form").is(":visible")||(squareCardCallBackHandle(),!1)},stripeResponseHandler=function(e,t){var a=o("#adminForm");if(t.error)alert(t.error.message),a.find("#btn-submit").prop("disabled",!1),a.find("#btn-process-group-billing").prop("disabled",!1);else{var n=t.id;o("#x_card_num").val(""),o("#x_card_code").val(""),o("#card_holder_name").val(""),a.append(o('<input type="hidden" name="stripeToken" />').val(n)),a.get(0).submit()}},stripeTokenHandler=function(e){var t=document.getElementById("adminForm"),a=document.createElement("input");a.setAttribute("type","hidden"),a.setAttribute("name","stripeToken"),a.setAttribute("value",e.id),t.appendChild(a),t.submit()},EBInitReCaptcha2=function(){var e,t=document.getElementById("eb_dynamic_recaptcha_1"),a=["sitekey","theme","size","tabindex","callback","expired-callback","error-callback"],n={};if(t.dataset)n=t.dataset;else for(var r=0;r<a.length;r++)e="data-"+a[r],t.hasAttribute(e)&&(n[a[r]]=t.getAttribute(e));t.setAttribute("data-recaptcha-widget-id",grecaptcha.render(t,n))},EBInitReCaptchaInvisible=function(){var e,t=document.getElementById("eb_dynamic_recaptcha_1"),a=["sitekey","badge","size","tabindex","callback","expired-callback","error-callback"],n={};if(t.dataset)n=t.dataset;else for(var r=0;r<a.length;r++)e="data-"+a[r],t.hasAttribute(e)&&(n[a[r]]=t.getAttribute(e));t.setAttribute("data-recaptcha-widget-id",grecaptcha.render(t,n)),grecaptcha.execute(t.getAttribute("data-recaptcha-widget-id"))},initializeTermsAndConditionsModal=function(){var e=document.querySelectorAll("a.eb-colorbox-term");0<e.length&&[].slice.call(e).forEach(function(a){a.addEventListener("click",function(e){e.preventDefault();var t=new tingle.modal({cssClass:["eb-terms-and-conditions-modal"],onClose:function(){t.destroy()}});t.setContent('<iframe width="100%" height="480px" src="'+a.href+'" frameborder="0" allowfullscreen></iframe>'),t.open()})})},ebShowPaymentMethodFields=function(e){var t,a=Joomla.getOptions("all_payment_method_fields",[]),n=Joomla.getOptions(e+"_fields",[]);a.forEach(function(e){-1===n.indexOf(e)&&(t=document.getElementById("field_"+e))&&(t.style.display="none")}),n.forEach(function(e){(t=document.getElementById("field_"+e))&&(t.style.display="")})}}(Eb.jQuery);